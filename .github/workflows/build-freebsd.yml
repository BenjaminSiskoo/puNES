name: Build on FreeBSD

on:
  push:
    #branches:
    #  - master
  #pull_request:
    #branches:
      #- master

concurrency:
  group: ${{ github.ref }}
  cancel-in-progress: true

jobs:
  build:
    runs-on: macos-12
    name: with Qt5 and FFmpeg
    steps:
    - uses: actions/checkout@v3
    - name: Test in FreeBSD
      id: test
      uses: vmactions/freebsd-vm@v0.3.0
      with:
        usesh: true
        mem: 2048
        sync: sshfs
        prepare: pkg install -y devel/cmake devel/ninja devel/pkgconf devel/git multimedia/ffmpeg audio/sndio devel/qt5-qmake devel/qt5-buildtools devel/qt5-core x11-toolkits/qt5-gui x11-toolkits/qt5-widgets graphics/qt5-svg devel/qt5-linguisttools
        run: |
          cmake -B build -G Ninja -DQt5_DIR=/usr/local/lib/qt5/cmake/Qt5 -DENABLE_RELEASE=ON -DENABLE_FFMPEG=ON .
          cmake --build build -j2
